# 進捗管理 (PROGRESS_TRACKER)

> **最終更新:** 2026-02-09

## 1. 全体進捗サマリー

| フェーズ                    | ステータス | 進捗率 |
| --------------------------- | ---------- | ------ |
| Phase 1: ローカル完結型 MVP | 🔄 進行中  | 95%    |
| Phase 2: コミュニティ機能   | ⬜ 未着手  | 0%     |
| Phase 3: マーケットプレイス | ⬜ 未着手  | 0%     |

---

## 2. Phase 1 ステップ別進捗

```
ステップ1 [██████████] 100%  初期セットアップ
ステップ2 [██████████] 100%  データモデル・ストア設計
ステップ3 [██████████] 100%  共通コンポーネント
ステップ4 [██████████] 100%  ダッシュボード
ステップ5 [██████████] 100%  カード登録/編集
ステップ6 [██████████] 100%  復習画面
ステップ7 [██████████] 100%  設定・エクスポート/インポート
ステップ8 [█████░░░░░]  50%  仕上げ
────────────────────────────────
合計       [█████████░]  95%
```

---

## 3. ステップ別タスク詳細

### ステップ 1: プロジェクト初期セットアップ — ✅ 完了

| #   | タスク                                             | 状態    | 備考                                     |
| --- | -------------------------------------------------- | ------- | ---------------------------------------- |
| 1-1 | Next.js プロジェクト作成（TypeScript, App Router） | ✅ 完了 | `npm run dev` で起動確認済み             |
| 1-2 | MUI v5 + Emotion のインストール・テーマ設定        | ✅ 完了 | カスタムテーマ適用済み                   |
| 1-3 | Zustand + 永続化ミドルウェアの導入                 | ✅ 完了 | persist で LocalStorage 保存動作確認     |
| 1-4 | その他ライブラリのインストール                     | ✅ 完了 | react-markdown, date-fns, uuid 等        |
| 1-5 | ディレクトリ構造の整備                             | ✅ 完了 | app/, lib/, stores/, components/, types/ |

### ステップ 2: データモデル・ストア設計 — ✅ 完了

| #   | タスク                                          | 状態    | 備考                                |
| --- | ----------------------------------------------- | ------- | ----------------------------------- |
| 2-1 | TypeScript 型定義（Deck, Card, StudyRecord 等） | ✅ 完了 | types/index.ts に定義済み           |
| 2-2 | デッキストア (`useDeckStore`) の実装            | ✅ 完了 | CRUD + replaceAll 実装済み          |
| 2-3 | カードストア (`useCardStore`) の実装            | ✅ 完了 | CRUD + 検索 + 復習対象取得 実装済み |
| 2-4 | 学習ストア (`useStudyStore`) の実装             | ✅ 完了 | 学習記録・ストリーク管理 実装済み   |
| 2-5 | IndexedDB ヘルパー（画像保存/取得/削除）        | ✅ 完了 | lib/imageDb.ts に実装済み           |
| 2-6 | SRS アルゴリズムの実装                          | ✅ 完了 | SM-2 ベース、lib/srs.ts に実装済み  |

### ステップ 3: 共通コンポーネント — ✅ 完了

| #   | タスク                              | 状態    | 備考                                                |
| --- | ----------------------------------- | ------- | --------------------------------------------------- |
| 3-1 | 共通レイアウト（Header, Container） | ✅ 完了 | AppLayout.tsx（ヘッダー + 設定アイコン + コンテナ） |
| 3-2 | Markdown プレビューコンポーネント   | ✅ 完了 | react-markdown + シンタックスハイライト             |
| 3-3 | 画像アップロードコンポーネント      | ✅ 完了 | ファイル選択 + プレビュー + バリデーション          |
| 3-4 | 確認ダイアログコンポーネント        | ✅ 完了 | ConfirmDialog.tsx                                   |

### ステップ 4: 画面実装 — ダッシュボード — ✅ 完了

| #   | タスク                   | 状態    | 備考                                     |
| --- | ------------------------ | ------- | ---------------------------------------- |
| 4-1 | 今日の復習セクション     | ✅ 完了 | TodayReviewCard.tsx                      |
| 4-2 | 学習サマリーセクション   | ✅ 完了 | StudySummaryCard.tsx                     |
| 4-3 | 定着度グラフ（円グラフ） | ✅ 完了 | MasteryChart.tsx（SVG ドーナツチャート） |
| 4-4 | デッキ一覧セクション     | ✅ 完了 | DeckList.tsx                             |
| 4-5 | デッキ作成ダイアログ     | ✅ 完了 | DeckList.tsx 内に統合                    |
| 4-6 | デッキ編集・削除機能     | ✅ 完了 | コンテキストメニュー付き                 |

### ステップ 5: 画面実装 — カード登録/編集 — ✅ 完了

| #   | タスク                                       | 状態    | 備考                         |
| --- | -------------------------------------------- | ------- | ---------------------------- |
| 5-1 | カード登録画面                               | ✅ 完了 | app/cards/new/page.tsx       |
| 5-2 | Markdown エディタ（ツールバー + プレビュー） | ✅ 完了 | CardForm.tsx 内に統合        |
| 5-3 | デッキ選択プルダウン                         | ✅ 完了 | CardForm.tsx 内に統合        |
| 5-4 | カード編集機能                               | ✅ 完了 | app/cards/[id]/edit/page.tsx |
| 5-5 | カード一覧表示（デッキ内）                   | ✅ 完了 | app/decks/[id]/page.tsx      |
| 5-6 | カード検索機能                               | ✅ 完了 | デッキ詳細ページ内に実装     |
| 5-7 | カード削除機能                               | ✅ 完了 | 確認ダイアログ付き           |

### ステップ 6: 画面実装 — 復習画面 — ✅ 完了

| #   | タスク                                   | 状態    | 備考                         |
| --- | ---------------------------------------- | ------- | ---------------------------- |
| 6-1 | 復習画面の基本レイアウト                 | ✅ 完了 | プログレスバー + 終了リンク  |
| 6-2 | カード表面表示                           | ✅ 完了 | Markdown + 画像              |
| 6-3 | 「答えを見る」→ 裏面表示                 | ✅ 完了 |                              |
| 6-4 | 自己評価ボタン（難しい / 普通 / 簡単）   | ✅ 完了 | SRS スケジュール更新連携済み |
| 6-5 | 次のカードへの遷移（アニメーション付き） | ✅ 完了 | fade 遷移                    |
| 6-6 | セッション完了画面                       | ✅ 完了 |                              |
| 6-7 | ストリーク更新処理                       | ✅ 完了 |                              |

### ステップ 7: 設定・エクスポート/インポート — ✅ 完了

| #   | タスク                     | 状態    | 備考                  |
| --- | -------------------------- | ------- | --------------------- |
| 7-1 | 設定画面                   | ✅ 完了 | app/settings/page.tsx |
| 7-2 | データエクスポート（JSON） | ✅ 完了 | lib/exportImport.ts   |
| 7-3 | データインポート（JSON）   | ✅ 完了 | lib/exportImport.ts   |

### ステップ 8: 仕上げ — 🔄 進行中

| #   | タスク                     | 状態      | 備考                                                 |
| --- | -------------------------- | --------- | ---------------------------------------------------- |
| 8-1 | レスポンシブデザインの調整 | ⚠️ 要確認 | MUI Grid/Stack 使用済み、実機での表示確認が必要      |
| 8-2 | 空状態のデザイン           | ✅ 完了   | EmptyState コンポーネント実装済み                    |
| 8-3 | エラーハンドリング         | ⚠️ 要確認 | 画像バリデーション実装済み、他のケースの網羅性を確認 |
| 8-4 | Vercel デプロイ確認        | ⬜ 未着手 | `npm run build` 成功 + Vercel 動作確認が必要         |

### ステップ 9: Prisma ORM 統合 — ✅ 完了

| #   | タスク                                         | 状態    | 備考                                        |
| --- | ---------------------------------------------- | ------- | ------------------------------------------- |
| 9-1 | Prisma + SQLite のセットアップ                 | ✅ 完了 | prisma/schema.prisma, lib/prisma.ts         |
| 9-2 | Prisma スキーマ定義（Deck, Card, StudyRecord） | ✅ 完了 | onDelete: Cascade 設定済み                  |
| 9-3 | API Routes の作成                              | ✅ 完了 | decks, cards, study-records, export, import |
| 9-4 | Zustand ストアの API 連携化                    | ✅ 完了 | persist 削除、async 化                      |
| 9-5 | DataInitializer コンポーネント                 | ✅ 完了 | layout.tsx に配置                           |
| 9-6 | ページ・コンポーネントの async 対応            | ✅ 完了 | 7 ファイル修正                              |
| 9-7 | エクスポート/インポートの API 経由化           | ✅ 完了 | lib/exportImport.ts                         |
| 9-8 | ビルド確認                                     | ✅ 完了 | `npm run build` 成功                        |

---

## 4. 実装済みファイル一覧

### コア（lib/）

| ファイル              | 概要                                      |
| --------------------- | ----------------------------------------- |
| `lib/srs.ts`          | SM-2 ベース SRS アルゴリズム              |
| `lib/imageDb.ts`      | IndexedDB による画像管理                  |
| `lib/theme.ts`        | MUI カスタムテーマ定義                    |
| `lib/exportImport.ts` | データエクスポート/インポート（API 経由） |
| `lib/prisma.ts`       | PrismaClient シングルトン                 |

### Prisma（prisma/）

| ファイル               | 概要                                           |
| ---------------------- | ---------------------------------------------- |
| `prisma/schema.prisma` | Prisma スキーマ定義（Deck, Card, StudyRecord） |

### ストア（stores/）

| ファイル                  | 概要                                     |
| ------------------------- | ---------------------------------------- |
| `stores/useDeckStore.ts`  | デッキ CRUD + API 連携                   |
| `stores/useCardStore.ts`  | カード CRUD + 検索 + 復習連携 + API 連携 |
| `stores/useStudyStore.ts` | 学習記録 + ストリーク管理 + API 連携     |

### 共通コンポーネント（components/common/）

| ファイル                                | 概要                       |
| --------------------------------------- | -------------------------- |
| `components/common/AppLayout.tsx`       | 共通レイアウト             |
| `components/common/ThemeRegistry.tsx`   | MUI テーマプロバイダ       |
| `components/common/DataInitializer.tsx` | アプリ起動時データフェッチ |
| `components/common/MarkdownPreview.tsx` | Markdown レンダリング      |
| `components/common/ImageUpload.tsx`     | 画像アップロード           |
| `components/common/ConfirmDialog.tsx`   | 確認ダイアログ             |
| `components/common/EmptyState.tsx`      | 空状態表示                 |

### 画面コンポーネント

| ファイル                                    | 概要                               |
| ------------------------------------------- | ---------------------------------- |
| `components/dashboard/TodayReviewCard.tsx`  | 今日の復習セクション               |
| `components/dashboard/StudySummaryCard.tsx` | 学習サマリー                       |
| `components/dashboard/MasteryChart.tsx`     | 定着度チャート                     |
| `components/dashboard/DeckList.tsx`         | デッキ一覧 + 作成/編集/削除        |
| `components/card/CardForm.tsx`              | カードフォーム + Markdown エディタ |
| `components/review/CardImage.tsx`           | カード画像表示                     |

### API Routes（app/api/）

| ファイル                             | 概要                   |
| ------------------------------------ | ---------------------- |
| `app/api/decks/route.ts`             | デッキ一覧取得・作成   |
| `app/api/decks/[id]/route.ts`        | デッキ取得・更新・削除 |
| `app/api/cards/route.ts`             | カード一覧取得・作成   |
| `app/api/cards/[id]/route.ts`        | カード取得・更新・削除 |
| `app/api/cards/[id]/review/route.ts` | 復習結果の反映         |
| `app/api/study-records/route.ts`     | 学習記録取得・復習記録 |
| `app/api/export/route.ts`            | 全データエクスポート   |
| `app/api/import/route.ts`            | 全データインポート     |

### ページ（app/）

| ファイル                       | 概要                     |
| ------------------------------ | ------------------------ |
| `app/page.tsx`                 | ダッシュボード           |
| `app/cards/new/page.tsx`       | カード新規作成           |
| `app/cards/[id]/edit/page.tsx` | カード編集               |
| `app/decks/[id]/page.tsx`      | デッキ詳細（カード一覧） |
| `app/review/page.tsx`          | 復習セッション           |
| `app/settings/page.tsx`        | 設定                     |

---

## 5. 残作業（Next Actions）

| 優先度 | タスク                   | 詳細                                                  |
| ------ | ------------------------ | ----------------------------------------------------- |
| 🔴 高  | レスポンシブデザイン確認 | PC / タブレット / スマートフォンでの表示確認・調整    |
| 🔴 高  | エラーハンドリング網羅   | インポート失敗時、ストレージ容量超過時等のケース対応  |
| 🔴 高  | Vercel デプロイ          | `npm run build` 成功確認 → Vercel デプロイ → 動作確認 |

---

## 6. 更新履歴

| 日付       | 内容                                                                                                                |
| ---------- | ------------------------------------------------------------------------------------------------------------------- |
| 2026-02-09 | 初版作成。ステップ 1〜7 完了、ステップ 8 一部進行中。                                                               |
| 2026-02-09 | Prisma ORM 統合（ステップ 9）完了。データ永続化を LocalStorage → SQLite に移行。                                    |
| 2026-02-09 | DeckList.tsx ハイドレーションエラー修正。Chip に `component="span"` を追加し、`<p>` 内の `<div>` ネスト問題を解消。 |
| 2026-02-09 | app/decks/[id]/page.tsx ハイドレーションエラー修正。同様に Chip に `component="span"` を追加。                      |
